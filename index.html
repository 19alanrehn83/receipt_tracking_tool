<!DOCTYPE html>
<html>
<head>
  <title>WWD Purchase Order System</title>
  <style>
    /* WickedWifeDesigns Color Palette - White/Black/Pink */
    :root {
      --bg-primary: #ffffff;
      --bg-secondary: #f5f5f5;
      --bg-tertiary: #e0e0e0;
      --accent-pink: #ff006e;
      --text-primary: #000000;
      --text-secondary: #444444;
      --border-color: #cccccc;
      --error-red: #d00000;
      --success-green: #2d6a4f;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--bg-primary);
      color: var(--text-primary);
      line-height: 1.6;
      padding: 2rem;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    /* Header - Black with Pink Accent */
    .header {
      text-align: center;
      margin-bottom: 3rem;
      padding: 2rem;
      background: #000000;
      border-radius: 12px;
      border: 2px solid var(--accent-pink);
    }

    .header h1 {
      font-size: 2.5rem;
      color: var(--accent-pink);
      margin-bottom: 0.5rem;
      font-weight: 800;
      letter-spacing: -1px;
    }

    .header .tagline {
      color: #ffffff;
      font-size: 0.9rem;
      letter-spacing: 2px;
      text-transform: uppercase;
      font-weight: 300;
    }

    /* Status Messages */
    #status {
      margin: 1rem 0;
      padding: 1rem;
      border-radius: 6px;
      display: none;
      font-weight: 500;
      border-left: 4px solid;
    }

    .success {
      background: rgba(45, 106, 79, 0.1);
      border-left-color: var(--success-green);
      color: var(--success-green);
    }

    .error {
      background: rgba(208, 0, 0, 0.1);
      border-left-color: var(--error-red);
      color: var(--error-red);
    }

    /* Sections - White with Black Borders */
    .section {
      background: var(--bg-primary);
      padding: 2rem;
      margin: 2rem 0;
      border-radius: 12px;
      border: 2px solid #000000;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .section h2 {
      color: #000000;
      margin-bottom: 1.5rem;
      font-size: 1.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-weight: 700;
    }

    .section h2::after {
      content: '';
      flex: 1;
      height: 2px;
      background: var(--accent-pink);
      margin-left: 1rem;
    }

    /* Form Grid */
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 1.5rem;
    }

    .form-group {
      display: flex;
      flex-direction: column;
    }

    label {
      color: var(--text-primary);
      font-size: 0.85rem;
      margin-bottom: 0.5rem;
      font-weight: 600;
    }

    input, select, textarea {
      background: var(--bg-secondary);
      border: 2px solid var(--border-color);
      color: var(--text-primary);
      padding: 0.75rem;
      border-radius: 6px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }

    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent-pink);
      box-shadow: 0 0 0 2px rgba(255, 0, 110, 0.2);
    }

    input[type="file"] {
      padding: 0.5rem;
      background: var(--bg-primary);
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    /* Line Items - Black Border with Pink Accent */
    .line-item {
      background: var(--bg-secondary);
      padding: 1.5rem;
      margin: 1rem 0;
      border-radius: 8px;
      border: 2px solid #000000;
      border-left: 6px solid var(--accent-pink);
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1rem;
    }

    .line-item h3 {
      grid-column: 1 / -1;
      color: var(--accent-pink);
      font-size: 1.1rem;
      margin-bottom: 0.5rem;
      font-weight: 700;
    }

    .receipt-preview {
      grid-column: 1 / -1;
      max-width: 250px;
      border-radius: 6px;
      border: 2px solid var(--accent-pink);
    }

    /* Buttons - Pink Gradient */
    .btn-primary {
      background: linear-gradient(135deg, var(--accent-pink), #c1121f);
      color: white;
      padding: 1rem 2rem;
      border: none;
      border-radius: 8px;
      font-size: 1.1rem;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      width: 100%;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(255, 0, 110, 0.3);
    }

    .btn-secondary {
      background: #000000;
      color: var(--accent-pink);
      border: 2px solid var(--accent-pink);
      padding: 0.75rem 1.5rem;
      border-radius: 6px;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-secondary:hover {
      background: var(--accent-pink);
      color: #ffffff;
    }

    /* Responsive */
    @media (max-width: 768px) {
      body { padding: 1rem; }
      .header h1 { font-size: 2rem; }
      .section { padding: 1.5rem; }
    }

    /* Required fields */
    input[required], select[required] {
      border-left: 4px solid var(--accent-pink);
    }

    .optional {
      color: var(--text-secondary);
      font-size: 0.8rem;
      font-style: italic;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>WICKEDWIFEDESIGNS</h1>
      <div class="tagline">Purchase Order Management System</div>
    </div>

    <div id="status"></div>

    <div class="section">
      <h2>ðŸ“‹ Purchase Order Header</h2>
      <div class="form-grid">
        <div class="form-group">
          <label>PO Number *</label>
          <input id="po_number" placeholder="PO-2024-001" required>
        </div>
        <div class="form-group">
          <label>Date *</label>
          <input id="date" type="date" required>
        </div>
        <div class="form-group">
          <label>Vendor/Supplier *</label>
          <input id="vendor" placeholder="Supplier Name" required>
        </div>
        <div class="form-group">
          <label>Shipping Total</label>
          <input id="shipping" type="number" placeholder="0.00" step="0.01">
        </div>
        <div class="form-group">
          <label>Payment Method *</label>
          <select id="payment_method" required>
            <option value="">Select Method</option>
            <option>Cash</option>
            <option>Debit</option>
            <option>Credit</option>
            <option>PayPal</option>
          </select>
        </div>
        <div class="form-group">
          <label>Notes <span class="optional">(optional)</span></label>
          <textarea id="notes" placeholder="Additional information..."></textarea>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>ðŸ“¦ Line Items</h2>
      <div id="line_items"></div>
      <button class="btn-secondary" onclick="addLineItem()">+ Add Line Item</button>
    </div>

    <button class="btn-primary" onclick="submitPO()">Submit Purchase Order</button>
  </div>

  <script>
    // CONFIGURATION - UPDATE THESE VALUES
    const API_KEY = 'sk_live_51Hx7yqL9K8a9J0mN3qR2pL7wX9zA4vB6cD3eF1gH8iJ5kM2nO0pQ1rS3tU4vW5';
    const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzx0tkr1A1QM7aC_fN3xDwkccE-FVqhx6R9ZvfA_MLVRu3biWhiB4j6T_baU5KyHZ0L/exec';

    // Simple password protection
    const TEAM_PASSWORD = 'WWD2024!'; // Change this!
    if (!sessionStorage.getItem('auth')) {
      const prompt = window.prompt('Enter team password:');
      if (prompt !== TEAM_PASSWORD) {
        document.body.innerHTML = '<div style="text-align:center; margin-top:5rem; font-size:2rem; color:#ff006e;">Access Denied</div>';
        throw new Error('Unauthorized');
      }
      sessionStorage.setItem('auth', 'true');
    }

    document.addEventListener('DOMContentLoaded', () => {
      document.getElementById('date').valueAsDate = new Date();
      addLineItem();
    });

    function showStatus(message, isSuccess = true) {
      const status = document.getElementById('status');
      status.textContent = message;
      status.className = isSuccess ? 'success' : 'error';
      status.style.display = 'block';
      setTimeout(() => status.style.display = 'none', 5000);
    }

    function addLineItem() {
      const div = document.createElement('div');
      div.className = 'line-item';
      div.innerHTML = `
        <h3>Line Item</h3>
        <div class="form-group">
          <label>Category *</label>
          <select class="category" required>
            <option value="">Select Category</option>
            <option>Advertising</option>
            <option>Car and truck expenses</option>
            <option>Commissions and fees</option>
            <option>Contract labor</option>
            <option>Depletion</option>
            <option>Employee benefit programs</option>
            <option>Insurance (other than health)</option>
            <option>Inventory</option>
            <option>Interest (other interest)</option>
            <option>Legal and professional services</option>
            <option>Office expense</option>
            <option>Pension and profit-sharing plans</option>
            <option>Rent or lease (vehicles, machinery & equipment)</option>
            <option>Rent or lease (other business property)</option>
            <option>Repairs and maintenance</option>
            <option>Supplies</option>
            <option>Taxes and licenses</option>
            <option>Travel, meals & entertainment</option>
            <option>Utilities</option>
            <option>Wages</option>
            <option>Other expenses</option>
          </select>
        </div>
        <div class="form-group">
          <label>Item Description *</label>
          <input class="item_desc" placeholder="Product/Service details" required>
        </div>
        <div class="form-group">
          <label>Quantity *</label>
          <input class="qty" type="number" min="1" placeholder="1" required>
        </div>
        <div class="form-group">
          <label>Unit Cost *</label>
          <input class="unit_cost" type="number" placeholder="0.00" step="0.01" required>
        </div>
        <div class="form-group">
          <label>Discount <span class="optional">(optional)</span></label>
          <input class="discount" type="number" placeholder="0.00" step="0.01" value="0">
        </div>
        <div class="form-group" style="grid-column: 1 / -1;">
          <label>Receipt <span class="optional">(JPG, PNG, PDF under 5MB)</span></label>
          <input type="file" class="receipt" accept="image/*,application/pdf" onchange="previewReceipt(this)">
        </div>
        <img class="receipt-preview" style="display: none;">
      `;
      document.getElementById('line_items').appendChild(div);
    }

    function previewReceipt(input) {
      if (!input.files || !input.files[0]) return;
      const preview = input.parentElement.parentElement.querySelector('.receipt-preview');
      const file = input.files[0];
      
      if (file.size > 5 * 1024 * 1024) {
        showStatus('File too large. Max 5MB.', false);
        input.value = '';
        return;
      }

      if (file.type.startsWith('image/')) {
        const reader = new FileReader();
        reader.onload = e => {
          preview.src = e.target.result;
          preview.style.display = 'block';
        };
        reader.readAsDataURL(file);
      } else {
        preview.style.display = 'none';
      }
    }

    async function submitPO() {
      // Validation
      const poNumber = document.getElementById('po_number').value.trim();
      const date = document.getElementById('date').value;
      const vendor = document.getElementById('vendor').value.trim();
      
      if (!poNumber || !date || !vendor) {
        showStatus('Please complete all required PO header fields', false);
        return;
      }

      const lineItems = document.querySelectorAll('.line-item');
      if (lineItems.length === 0) {
        showStatus('Please add at least one line item', false);
        return;
      }

      showStatus('Submitting PO... Please wait', true);

      try {
        // Submit PO header
        const poData = {
          type: 'po',
          po_number: poNumber,
          date: date,
          vendor: vendor,
          shipping: parseFloat(document.getElementById('shipping').value) || 0,
          payment_method: document.getElementById('payment_method').value,
          notes: document.getElementById('notes').value
        };

        const response = await fetch(`${APPS_SCRIPT_URL}?key=${API_KEY}`, {
          method: 'POST',
          body: JSON.stringify(data),
          mode: no-cors', // This bypasses CORS checks
          headers: { 'Content-Type': 'application/json' }
        });

        const result = await response.json();
        if (result.error) throw new Error(result.error);

        // Submit line items
        for (let i = 0; i < lineItems.length; i++) {
          const item = lineItems[i];
          const category = item.querySelector('.category').value;
          const desc = item.querySelector('.item_desc').value;
          const qty = item.querySelector('.qty').value;
          const unitCost = item.querySelector('.unit_cost').value;
          const discount = item.querySelector('.discount').value || 0;
          const fileInput = item.querySelector('.receipt');

          if (!category || !desc || !qty || !unitCost) {
            showStatus(`Line item ${i+1} is incomplete`, false);
            return;
          }

          let receiptData = null;
          if (fileInput.files && fileInput.files[0]) {
            const file = fileInput.files[0];
            if (file.size > 5 * 1024 * 1024) {
              showStatus('Receipt file exceeds 5MB limit', false);
              return;
            }
            receiptData = await new Promise(resolve => {
              const reader = new FileReader();
              reader.onload = e => resolve({
                name: file.name,
                mime: file.type,
                data: e.target.result.split(',')[1]
              });
              reader.readAsDataURL(file);
            });
          }

          const lineData = {
            type: 'line_item',
            po_number: poNumber,
            category: category,
            item_description: desc,
            quantity: qty,
            unit_cost: unitCost,
            discount: discount,
            receipt: receiptData
          };

          await fetch(`${APPS_SCRIPT_URL}?key=${API_KEY}`, {
            method: 'POST',
            body: JSON.stringify(lineData),
            mode: 'cors',
            headers: { 'Content-Type': 'application/json' }
          });
        }

        showStatus('âœ… PO submitted successfully!', true);
        setTimeout(() => location.reload(), 2000);

      } catch (error) {
        console.error('Submission error:', error);
        showStatus(`Submission failed: ${error.message}`, false);
      }
    }
  </script>
</body>
</html>



